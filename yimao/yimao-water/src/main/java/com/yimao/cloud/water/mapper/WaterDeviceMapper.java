package com.yimao.cloud.water.mapper;

import com.github.pagehelper.Page;
import com.yimao.cloud.pojo.bo.ProvinceCityRegion;
import com.yimao.cloud.pojo.dto.order.SalesStatsDTO;
import com.yimao.cloud.pojo.dto.station.RenewStatisticsDTO;
import com.yimao.cloud.pojo.dto.water.WaterDeviceCompleteDTO;
import com.yimao.cloud.pojo.dto.water.WaterDeviceDTO;
import com.yimao.cloud.pojo.dto.water.WaterDeviceReplaceRecordDTO;
import com.yimao.cloud.pojo.export.water.DeviceListExport;
import com.yimao.cloud.pojo.export.water.FilterReplaceExport;
import com.yimao.cloud.pojo.query.station.StationWaterDeviceQuery;
import com.yimao.cloud.pojo.query.water.WaterDeviceQuery;
import com.yimao.cloud.pojo.vo.station.StationWaterDeviceVO;
import com.yimao.cloud.pojo.vo.water.WaterDeviceAreaClassificationVO;
import com.yimao.cloud.pojo.vo.water.WaterDeviceVO;
import com.yimao.cloud.water.po.WaterDevice;
import org.apache.ibatis.annotations.Param;
import tk.mybatis.mapper.common.Mapper;

import java.math.BigDecimal;
import java.util.Date;
import java.util.List;
import java.util.Map;

public interface WaterDeviceMapper extends Mapper<WaterDevice> {

    Page<WaterDeviceDTO> selectPage(WaterDeviceQuery query);

    Page<WaterDeviceDTO> pageDeviceForEngineerApp(@Param("engineerId") Integer engineerId, @Param("search") String search);

    Page<WaterDeviceVO> selectWaterDeviceVO(WaterDeviceQuery query);

    WaterDeviceVO selectDetailById(@Param("id") Integer id);

    /**
     * 按省分组统计设备数量并倒叙排序
     */
    List<WaterDeviceAreaClassificationVO> countByProvince();

    /**
     * 按设备型号分组统计设备数量并倒叙排序
     */
    List<WaterDeviceAreaClassificationVO> countByDeviceModel();

    /**
     * 按激活日期统计分类
     *
     * @param startTime 开始日期
     * @param endTime   结束日期
     */
    List<WaterDeviceAreaClassificationVO> countByTrend(@Param("startTime") String startTime, @Param("endTime") String endTime);

    boolean existsWithOldId(@Param("oldId") String oldId);

    /**
     * 根据ID获取水机设备对应的计费方式信息
     *
     * @param id ID
     */
    WaterDeviceDTO selectByIdForChangeCost(@Param("id") Integer id);

    void updateSimAccountIdToNull(@Param("id") Integer id);


    /***
     * 功能描述:水机趋势（1周）
     *
     * @param: [mark]
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     * @return: java.util.Map<java.lang.String                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               java.lang.Object>
     */
    List<Map<String, Object>> oneWeekWaterDeviceTotalCount(@Param(value = "type") Integer type);


    /***
     * 功能描述:水机趋势（8周）
     *
     * @param: [mark]
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     * @return: java.util.Map<java.lang.String                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               java.lang.Object>
     */
    List<Map<String, Object>> eightWeekWaterDeviceTotalCount(@Param(value = "type") Integer type);

    /***
     * 功能描述:水机趋势（半年）
     *
     * @param: [mark]
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     * @return: java.util.Map<java.lang.String                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               java.lang.Object>
     */
    List<Map<String, Object>> sixMonthWaterDeviceTotalCount(@Param(value = "type") Integer type);


    /***
     * 功能描述:设备总数
     *
     * @param: [yesterday]
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     * @return: java.util.Map<java.lang.String                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               java.lang.Object>
     */
    Integer deviceTotalCount(@Param(value = "yesterday") Integer yesterday);

    /***
     * 功能描述:续费总数
     *
     * @param: [yesterday]
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     * @return: java.util.Map<java.lang.String                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               java.lang.Object>
     */
    Integer renewTotalCount(@Param(value = "yesterday") Integer yesterday);

    /***
     * 功能描述:首年销售总额
     *
     * @param: [yesterday]
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     * @return: java.util.Map<java.lang.String                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               java.lang.Object>
     */
    BigDecimal deviceTotal(@Param(value = "yesterday") Integer yesterday);

    /***
     * 功能描述:续费销售总额
     *
     * @param: [yesterday]
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     */
    BigDecimal renewDeviceTotal(@Param(value = "yesterday") Integer yesterday);

    /***
     * 功能描述:设备在线统计（在线和离线）
     *
     * @param: [online]
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     */
    Integer onlineTotalCount(@Param(value = "online") Integer online);

    Integer stationOnlineTotalCount(Map<String, Object> queryMap);

    /***
     * 功能描述:设备型号统计
     *
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     */
    List<Map<String, Object>> modelTotalCount();

    List<Map<String, Object>> stationModelTotalCount(@Param("engineerIds") List<Integer> engineerIds);

    /***
     * 功能描述:设备计费类型统计
     *
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     * @return: java.util.Map<java.lang.String                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               java.lang.Object>
     */
    List<Map<String, Object>> costTotalCount();

    List<Map<String, Object>> stationCostTotalCount(@Param("engineerIds") List<Integer> engineerIds);

    /***
     * 功能描述:按省份统计设备安装数量(首年和续费)
     *
     * @param: [renewTime]
     * @auther: liu yi
     * @date: 2019/7/31 11:12
     * @return: java.util.Map<java.lang.String                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               java.lang.Object>
     */
    List<Map<String, Object>> provinceWaterDeviceTotalCount(@Param(value = "renewTime") Integer renewTime);

    /***
     * 功能描述:所有设备续费状态统计
     *
     * @param: []
     * @auther: liu yi
     * @date: 2019/7/31 15:26
     */
    List<Map<String, Object>> allWaterDeviceRenewTotalCount();

    List<Map<String, Object>> stationAllWaterDeviceRenewTotalCount(@Param("engineerIds") List<Integer> engineerIds);

    /**
     * 根据条件查询设备数量
     */
    int countDevice(@Param(value = "pcrs") List<ProvinceCityRegion> pcrs,
                    @Param(value = "beginTime") Date beginTime,
                    @Param(value = "endTime") Date endTime,
                    @Param(value = "connType") Integer connType,
                    @Param(value = "models") List<String> models,
                    @Param(value = "online") Boolean online,
                    @Param(value = "location") String location,
                    @Param(value = "sn") String sn,
                    @Param(value = "keyWord") String keyWord,
                    @Param(value = "createTime") Date createTime);

    Page<WaterDeviceDTO> selectDeviceRenewInfoForApp(@Param(value = "column") Integer column, @Param(value = "distributorId") Integer distributorId);

    WaterDevice selectBasicInfoBySn(@Param(value = "sn") String sn);

    WaterDevice selectBasicInfoById(@Param(value = "id") Integer id);

    void updateChangedCostInfo(@Param(value = "id") Integer id,
                               @Param(value = "newCostId") Integer newCostId,
                               @Param(value = "newCostName") String newCostName,
                               @Param(value = "newCostType") Integer newCostType);

    void updateForPadSyncData(WaterDevice update);

    int updateToOffline(@Param(value = "compareTime") Date compareTime);

    Page<FilterReplaceExport> filterReplaceExport(WaterDeviceQuery query);

    void updateForChangeDevice(WaterDevice update);

    void updateForTransferDistributor(@Param(value = "oldDistributorId") Integer oldDistributorId,
                                      @Param(value = "newDistributorId") Integer newDistributorId,
                                      @Param(value = "newDistributorName") String newDistributorName,
                                      @Param(value = "newDistributorPhone") String newDistributorPhone);

    void updateDeviceUserInfo(@Param(value = "deviceUserId") Integer deviceUserId,
                              @Param(value = "deviceUserName") String deviceUserName,
                              @Param(value = "deviceUserPhone") String deviceUserPhone);

    void updateArrearsTimeToNullById(Integer id);

    Page<DeviceListExport> waterDeviceListExport(WaterDeviceQuery deviceQuery);

    Page<StationWaterDeviceVO> selectPageToStation(StationWaterDeviceQuery query);

    RenewStatisticsDTO getWaterDeviceRenewData(StationWaterDeviceQuery waterDeviceQuery);

    List<RenewStatisticsDTO> getWaterDeviceRenewPicData(StationWaterDeviceQuery waterDeviceQuery);

    Integer getDeviceTotalNum(@Param("engineerIds") List<Integer> engineerIds);

    Integer getYesterdayNewInstallNum(@Param("engineerIds") List<Integer> engineerIds);

    List<SalesStatsDTO> getDeviceRenewPropList(@Param("ids") List<Integer> ids);

    void updateWaterDeviceForEngineer(WaterDeviceDTO wdd);

    void updateDeviceForEngineerPhone(WaterDeviceDTO update);

    List<Integer> selectWaterDeviceByPrc(WaterDeviceDTO wdd);

    List<WaterDeviceDTO> getWaterDeviceList(WaterDeviceQuery query);

    Page<WaterDeviceReplaceRecordDTO> getWaterDeviceReplaceBySn(String sn);

    Page<WaterDeviceCompleteDTO> getCompleteWorkOrderList(String key, Integer engineerId);

}
